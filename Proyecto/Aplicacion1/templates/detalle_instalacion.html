{% load custom_filters %}

<!DOCTYPE html>
<html lang="es">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>{{ instalacion.nombre }} - Detalles</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
   <style>
       .disponible {
           background-color: #28a745; /* Verde */
           color: white;
           padding: 5px 10px;
           border-radius: 5px;
           font-weight: bold;
       }
       .reservado {
           background-color: #dc3545; /* Rojo */
           color: white;
           padding: 5px 10px;
           border-radius: 5px;
           font-weight: bold;
       }
       .card-body {
           padding: 20px;
       }
       .card-title {
           font-size: 1.25rem;
           font-weight: bold;
       }
       .footer {
           background-color: #343a40;
           color: white;
       }
   </style>
</head>
<body>
   <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
       <a class="navbar-brand" href="#">Sistema de Reservas</a>
       <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
           <span class="navbar-toggler-icon"></span>
       </button>
       <div class="collapse navbar-collapse" id="navbarNav">
           <ul class="navbar-nav">
               <li class="nav-item">
                   <a class="nav-link active" aria-current="page" href="{% url 'index' %}">Inicio</a>
               </li>
               <li class="nav-item">
                   <a class="nav-link" href="{% url 'instalacion_list' %}">Instalaciones</a>
               </li>
               <li class="nav-item">
                   <a class="nav-link" href="{% url 'logout' %}">Cerrar sesión</a>
               </li>
           </ul>
       </div>
   </nav>

   <div class="container mt-5">
       <h1>Detalles de la instalación: {{ instalacion.nombre }}</h1>

       <h3>Campos disponibles:</h3>
       {% if campos %}
           <div class="row">
               {% for campo in campos %}
                   <div class="col-md-4 mb-4">
                       <div class="card shadow-sm">
                           <div class="card-body">
                               <h5 class="card-title">{{ campo.nombre }}</h5>
                               <p><strong>Tipo de campo:</strong> {{ campo.tipo_campo }}</p>
                               <p><strong>Capacidad:</strong> {{ campo.capacidad_jugadores }} jugadores</p>

                               <h6>Horarios disponibles:</h6>
                               <table class="table table-striped table-bordered">
                                   <thead>
                                       <tr>
                                           <th>Hora</th>
                                           <th>Disponibilidad</th>
                                       </tr>
                                   </thead>
                                   <tbody>
                                       {% for hora in horarios_disponibles %}
                                           {% with reservas=reservas_por_campo|get_item:campo.id %}
                                               {% with estado=reservas|get_item:hora %}
                                                   <tr>
                                                       <td>{{ hora|date:"H:i" }}</td>
                                                       <td>
                                                           {% if estado == 'reservado' %}
                                                               <span class="reservado">Reservado</span>
                                                           {% else %}
                                                               <span class="disponible">Disponible</span>
                                                           {% endif %}
                                                       </td>
                                                   </tr>
                                               {% endwith %}
                                           {% endwith %}
                                       {% endfor %}
                                   </tbody>
                               </table>

                               <!-- Botón para reservar si está disponible -->
                               <div class="text-center mt-3">
                                   {% if estado != 'reservado' %}
                                       <a href="{% url 'reservar_campo' campo.id %}" class="btn btn-success">Reservar Campo</a>
                                   {% endif %}
                               </div>
                           </div>
                       </div>
                   </div>
               {% endfor %}
           </div>
       {% else %}
           <p>No hay campos disponibles en esta instalación.</p>
       {% endif %}
   </div>

   <footer class="footer mt-5 text-white text-center py-3">
       <p>&copy; 2025 Sistema de Reservas. Todos los derechos reservados.</p>
   </footer>

   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
